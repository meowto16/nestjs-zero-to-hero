# Введение в контроллеры NestJS

- Ответственность контроллеров: обработка входящих запросов и возврат ответа клиенту
- Привязаны к определенному пути (например: `/tasks` для `task resource`)
- Содержит обработчики, которые обрабатывают эндпоинты и методы запроса (`GET`, `POST`, `DELETE` и так далее)
- Может пользоваться *dependency injection* для использования провайдеров в пределах одного модуля

## Объявление контроллера

Контроллеры объявляются при помощи декорации класса декоратором `@Controller` 

Декоратор принимает строку **(путь)** который обрабатывается данным контроллером.

Пример: 
```typescript
@Controller('/tasks')
export class TasksController {
  // ...
}
```

## Объявление обработчика

Обработчики — это простые методы внутри класса контроллера, которые были декорированы с помощью
декораторов вроде `@Get`, `@Post`, `@Delete` и так далее.

Пример: 
```typescript
@Controller('/tasks')
export class TasksController {
  @Get()
  getAllTasks() {
    // do stuff
    return ...;
  }
  
  @Post()
  createTask() {
    // do stuff
    return ...;
  }
}
```

### Путь прохождения запроса
![1. Путь прохождения запроса](./img/1.%20Request%20Flow.png)

1. Пришел HTTP запрос
2. Запрос перенаправляется в контроллер, обработчик вызывается с аргументами 
    1. NestJS спарсит необходимые данные из запроса и они будут доступны в обработчике
3. Обработчик обрабатывает запрос
    1. Исполнение операций, вроде коммуникации с сервисом. Например, получение элемента из БД.
4. Обработчик возвращает значение ответа
    1. Ответ может быть любого типа, даже exception. Nest обернет возвращаемое значение в HTTP ответ и вернет
    его клиенту

### Структура контроллеров в текущем проекте
![2. Структура контроллеров](./img/2.%20Controllers%20structure.png)

### Пример перенаправления запроса на обработчик
![3. Пример перенаправления запроса на обработчик](./img/3.%20Routing%20example.png)

Резюмируя — это некий слой абстракции между клиентом и сервером
